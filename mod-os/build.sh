#!/bin/bash

#######################################################################################################################
# exit if any command fails

set -e

cd $(dirname ${0})

#######################################################################################################################
# cleanup

rm -f rootfs.ext2

#######################################################################################################################
# create mod-os image

docker build -t mod-live-usb_mod-os .

#######################################################################################################################
# fetch rootfs.ext2 from image

docker run -v ${PWD}:/opt/mount --rm --entrypoint \
    cp mod-live-usb_mod-os:latest /home/builder/mod-workdir/x86_64/images/rootfs.ext2 /opt/mount/rootfs.ext2

#######################################################################################################################
# mark as done

touch .stamp_built

#######################################################################################################################
